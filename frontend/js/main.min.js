$(function(){"use strict";function t(t,e){var i=t.twists,a=[];return $(e.split("")).each(function(){var t=this[0],e=i.filter(function(e){return e.charId===t});a.push(e[0])}),{twists:a}}function e(){$("#rate,#rate-tab").addClass("active in")}function i(){$("#overview,#overview-tab").addClass("active in")}function a(a){var o=$(location).attr("href").split("#")[1]||"fail",r=t(a,o);r.twists.length===a.twists.length?(a=r,e()):i(),$("#twist-list-template-output").html(c(a)),$("#sortable-twist-list").sortable()}function o(t){$("#twist-overview-template-output").html(p(t)),$(".twist-wrapper").last().css("margin-bottom","70px"),$(".btn-twist").click(function(){var t=$(this).data("id"),e=$(this).data("value");$.ajax({url:"http://twistrating.apiary-mock.com/twists",type:"POST",data:JSON.stringify({id:t,rating:e}),contentType:"application/json; charset=utf-8",dataType:"json"})})}function r(){var t="";return $("#sortable-twist-list li").each(function(){t+=$(this).data("charid")}),t}function n(){$(".copy-link").click(function(){$(".link-container").text("http://twistrating.no#"+r()),$(".link-container").attr("href","http://twistrating.no#"+r())})}function s(){$(".share-on-facebook").click(function(){console.log("TwistRating: "+r()),FB.ui({method:"share",href:"http://twistrating.no#"+r()},function(){})})}function l(){$.getJSON("http://twistrating.apiary-mock.com/twists",function(t){a(t),o(t)}).done(function(){console.log("Lastet ned twist fra APIet")}).fail(function(){alert("Fant ingen twist i APIet... :/")})}var p=Handlebars.compile($("#twist-overview-template").html()),c=Handlebars.compile($("#twist-list-template").html());s(),n(),l()});